<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="format-detection" content="email=no">
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Expires" content="0" />
  <title>云相册</title>
  <script>
    //rem
    (function (doc, win) {
      var docEl = doc.documentElement,
        resizeEvt = 'orientationchange' in window ? 'orientationchange' : 'resize',
        recalc = function () {
          var clientWidth = docEl.clientWidth;
          if (!clientWidth) return;
          if (clientWidth >= 1080) {
            docEl.style.fontSize = '100px';
          } else {
            docEl.style.fontSize = 100 * (clientWidth / 1080) + 'px';
          }
        };
      if (!doc.addEventListener) return;
      win.addEventListener(resizeEvt, recalc, false);
      doc.addEventListener('DOMContentLoaded', recalc, false);
    })(document, window);
  </script>
  
  <script src="./js/jquery.min.js"></script>
  <script src="./js/layer_mobile/layer.js"></script>
  <script src="./js/util.js"></script>
  <script src="./js/vue.min.js"></script>
  <script src="https://res2.wx.qq.com/open/js/jweixin-1.6.0.js "></script>
  <script src="./js/share.js"></script>
  
  <link rel="stylesheet" href="./css/base.css">
  <style>
    .album-bg{
      background-size: 100% 100%;
      background-repeat: no-repeat;
      width: 100%;
      height: 100%;
      position: absolute;
      background-image: url(./img/album-bg.jpg);
    }
  </style>
</head>
<body>
  <div id="app" v-cloak>
    <div class="album-bg">

    </div>
  </div>
  
  <script>
    var vm = new Vue({
      el: '#app',
      data: {
        openid: '',
        menu:{
          // sid: "E3944FC892AC11EBA15800163E32A83E",
          // chuangyiheyin: 0,
          // tijiaoxinxi: 0,
          // yunxiangche: 0
        },
        info:{
          // "sid": "A371F57B926711EBA15800163E32A83E",
          // "nickname": "杜爱枝",
          // "headImg": "https://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJM33scbPPPvpP94WswdD9hwyVgDB71FiaYz8jMDdEs3nDO2JkmGnKs9dSV8ucRF72Y1A1ZyCZb0hw/132",
          // "openid": "oarFBv5e9Up-N7f4SIDdIDCHgF7A",
          // "seatid": 0,
          // "realname": "杜爱枝",
          // "mobile": "13622221111",
          // "company": "社会",
          // "position": "额呵呵",
          // "photoName": "",
          // "photoHeader": "",
          // "isBm": "1",
          // "isQd": "0"
        },
        dateList:[
          {
            value: '4月6日'
          },
          {
            value: '4月7日'
          },
          {
            value: '4月8日'
          },
          {
            value: '4月9日'
          },
          {
            value: '4月10日'
          },
        ],
        tripLayerShow: false,
        active: 0
      },
      created: function () {
        this.openid = getOpenid()
        setLoc('openid', this.openid)
        console.log(this.openid)
        this.getMenu()
      },
      mounted: function () {
        $(document).on('click', '.close', function() {
          layer.closeAll()
        });
      },
      methods: {
        getMenu(){
          let self = this
          ajaxGet(
            apipath + '/aoc/api/app/aocjindu/get', 
            {},
            function (res) {
              console.log(res);
              if(res.status == 200){
                self.menu=res.results
              }
            },
            function (res) {
              console.log(res);
            }
          )
        },
        gotoSignup(){
          let self = this
          ajaxGet(
            apipath + '/aoc/api/app/aocuser/get/' + self.openid, 
            {},
            function (res) {
              console.log(res);
              if(res.status == 200){
                self.info=res.results
                if(self.info && self.info.isBm==1){
                  window.location.href='./signupSuc.html'
                } else if(self.menu.tijiaoxinxi==1){
                  window.location.href='./signup.html'
                } else if(self.menu.tijiaoxinxi==0){
                  layer.open({
                      type: 1,
                      content: $('.endedLayer').html(),
                      shade: 'background-color: rgba(0,0,0,.8)', //自定义遮罩的透明度
                      style: 'background:none; border:none;' //自定风格
                  });
                }
              } else {
                layerMsg(res.msg);
              }
            },
            function (res) {
              console.log(res);
            }
          )
        },
        
        gotoPhoto(){
          let self = this
          ajaxGet(
            apipath + '/aoc/api/app/aocuser/get/' + self.openid, 
            {},
            function (res) {
              console.log('aocuser/get==',res);
              if(res.status == 200){
                self.info = res.results
                if(self.info && self.info.isQd==1){
                  window.location.href='./creatSign.html'
                } else {
                  layer.open({
                    type: 1,
                    content: $('.signTip').html(),
                    shade: 'background-color: rgba(0,0,0,.8)', //自定义遮罩的透明度
                    style: 'background:none; border:none;' //自定风格
                  })
                }
              } else {
                layerMsg(res.msg);
              }
            },
            function (res) {
              console.log(res);
            }
          )
        },
        gotoAlbum(){
          if(this.menu.yunxiangche==1){
            window.location.href='./cloudAlbum.html'
          } else {
            layer.open({
              type: 1,
              content: $('.notStartedLayer').html(),
              shade: 'background-color: rgba(0,0,0,.8)', //自定义遮罩的透明度
              style: 'background:none; border:none;' //自定风格
            });
          }
        },
        gotoTrip(){
          this.tripLayerShow = true
        },
        dateTabClick(index){
          console.log(index)
          this.active = index
        }
      }
    })
    
  </script>
</body>
</html>